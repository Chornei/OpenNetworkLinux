############################################################
#
# Standard ONL Root Filesystem Configuration.
#
# Requires:
#     ARCH, PLATFORM_LIST
#
#
############################################################
Packages: &Packages
  - !include $ONL/packages/base/any/rootfs/common/common-packages.yml
  - !include $ONL/packages/base/any/rootfs/common/${ARCH}-packages.yml
  - !script  $ONL/tools/onl-platform-pkgs.py ${PLATFORM_LIST}

Multistrap:
  General:
    arch: ${ARCH}
    cleanup: true
    noauth: true
    explicitsuite: false
    unpack: true
    debootstrap: Debian Local-All Local-Arch
    aptsources: Debian

  Debian:
    packages: *Packages
    source: http://${APT_CACHE}${DEBIAN_MIRROR}
    suite: ${DEBIAN_SUITE}
    keyring: debian-archive-keyring
    omitdebsrc: true

  Local-All:
    source: ${ONL}/REPO/packages/all
    omitdebsrc: true

  Local-Arch:
    source: ${ONL}/REPO/packages/${ARCH}
    omitdebsrc: true

Configure:
  overlays:
    - ${ONL}/packages/base/any/rootfs/common/overlay

  update-rc.d:
    - 'initdev defaults'
    - 'onl-platform-baseconf defaults'
    - 'faultd defaults'
    - 'snmpd remove'
    - 'ssh defaults'
    - 'openbsd-inetd remove'
    - 'ntp remove'
    - 'nfs-common remove'
    - 'rpcbind remove'
    - 'motd remove'
    - 'mountall-bootclean.sh remove'
    - 'mountall.sh remove'
    - 'checkfs.sh remove'
    - 'mtab.sh remove'
    - 'checkroot-bootclean.sh remove'
    - 'checkroot.sh remove'
    - 'mountnfs-bootclean.sh remove'
    - 'mountnfs.sh remove'
    - 'lm-sensors remove'
    - 'netplug defaults'
    - 'watchdog defaults'
    - 'wd_keepalive remove'

  options:
    clean: True
    securetty: False
    ttys: False
    console: True

  users:
    root:
      password: onl

  manifest:
    version: $ONL/make/version-onl.json
    platforms: $PLATFORM_LIST

